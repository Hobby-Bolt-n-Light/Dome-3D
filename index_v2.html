<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>Bilder's 3D Archive</title>
	
	<!-- A-Frame -->
    <meta name="description" content="Laser input UI â€¢ A-Frame">
	<script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.5.x/dist/aframe-environment-component.min.js"></script>
	
	<!-- Extrasï¼ˆç§»å‹•ãƒ»è£œåŠ©ç”¨ï¼‰ -->
	<script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
	
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100..900&family=Outfit:wght@100..900&family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">
	
	<style>
		body { margin: 0; overflow: hidden; font-family: sans-serif;}
		html { touch-action: manipulation;}
		
		/* ç§»å‹•UI */
		.ui {
		  position:fixed;
		  bottom: 20px;
		  left: 50%;
		  transform: translateX(-50%);
		  display: flex;
		  gap: 10px;
		  z-index: 10;
		}
		.ui button {
		  padding: 12px 16px;
		  font-size: 16px;
		  opacity: 0.8;
		}
		  
		#intro {
		  position: fixed;
		  inset: 0;
		  background: rgba(0,0,0,0.7);
		  color: white;
		  display: flex;
		  align-items: center;
		  justify-content: center;
		  text-align: center;
		  z-index: 20;
		  font-size: 5vmin;
		  font-family: "Zen Kaku Gothic New", sans-serif;
		  font-weight: bold;
		  font-style: normal;
		}
		  
		#loading {
		  position: fixed;
		  inset: 0;
		  background: rgba(0,0.5,0.8,1);
		  color: white;
		  display: flex;
		  align-items: center;
		  justify-content: center;
		  text-align: center;
		  z-index: 30;
		  font-size: 4vmin;
		  font-family: "Zen Kaku Gothic New", sans-serif;
		  font-weight: bold;
		  font-style: normal;
		}

		#buttonClose{
			position:absolute;
			background:#fff;
			top:20px;
			left:20px;
			width: 5vmin;
			height: 5vmin;
  			border: none;
			font-size: 3vmin;
			font-weight: bolder;
			color: #124;
			z-index: 999;
			border-radius: 100%;
			text-align: center;
		}
		#popup_infoArea{
			position:absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			width: 80%;
			max-width: 500px;
			height: 80%;
			background-color: aliceblue;
			border: 5px solid #8ad;
			transition: .1s;
		}
		#infoText{
			height: 70%;
			width: 100%;
			max-width: 500px;
			margin: 0 auto;
			background-color: #00f8;
			color: #224;
			bottom: 0;
			padding: 10px;
			margin: 0 auto;
		}
		#popup_text {
			height: 60%;
			background: #fff;
			padding: 16px;
			box-sizing: border-box;
			text-align: left;
		}
		#popup_image {
			background-color: #fff;
			height: 40%;
			width: 100%;
			overflow: hidden;
			object-fit: cover;
		}
		#popup_image img {
			width: 100%;
			height: 100%;
			max-width: 100%;
			max-height: 100%;
			display: block;
			object-fit: cover;
		}
		#popup_text_title{
			font-weight: bolder;
			font-size: 1.5em;
			margin-top: 5px;
			margin-bottom: 20px;
			color:#8ad;
		}
		#popup_text_main{
			font-weight: normal;
			color: #346;
		}
	</style>
</head>

<body>

<!-- UIãƒœã‚¿ãƒ³ -->
<div class="ui">
	<div id="text">ãƒ†ã‚¹ãƒˆãƒ†ã‚­ã‚¹ãƒˆ</div>
	<button onmousedown="startMove(0, 1)" onmouseup="stopMove()" ontouchstart="startMove(0, 1)" ontouchend="stopMove()">ãƒœã‚¿ãƒ³</button>
</div>

<!-- ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—æœ¬ä½“ -->
<div id="popup" style="
	position: fixed;
	inset: 0;
	background: #2483;
	color: white;
	visibility: hidden;
	opacity: 0;
	z-index: 40;
	padding: 5vmin;
	transition: all 0.3s;
	backdrop-filter: blur(5px);
	">
	<div id="popup_infoArea">
		<!-- é–‰ã˜ã‚‹ãƒœã‚¿ãƒ³ -->
		<button id="buttonClose" onclick="closeInfo()">Ã—</button>

		<!-- ä¸Šéƒ¨ï¼šç”»åƒã‚¨ãƒªã‚¢ -->
		<div id="popup_image">
			<img id="popup_imgTag" src="" alt="ç”»åƒ">
		</div>
		<hr style="opacity: 0.1; padding: 0; margin: 0;">
		<!-- ä¸‹éƒ¨ï¼šãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ -->
		<div id="popup_text">
			<div id="popup_text_title">ã‚¿ã‚¤ãƒˆãƒ«</div>
			<div id="popup_text_main">
				<p>
				ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆãŒå…¥ã‚Šã¾ã™ã€‚<br>
				å·¦æƒãˆã§ã€å‘¨å›²ã«å°‘ã—ä½™ç™½ãŒã‚ã‚Šã¾ã™ã€‚<br>
				èª¬æ˜æ–‡ã‚„æ³¨æ„æ›¸ããªã©ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚
				</p>
			</div>
		</div>
	</div>
</div>




<!-- æ¡ˆå†…è¡¨ç¤º -->
<div id="loading">
  èª­ã¿è¾¼ã¿ä¸­â€¦
</div>
<div id="intro">
  <p>å·¦å³ã«ã‚¹ãƒ¯ã‚¤ãƒ—ã—ã¦å‘ãå¤‰æ›´<br>
  ç”»é¢ä¸‹ã®ãƒœã‚¿ãƒ³ã§ç§»å‹•<br><br>
  ã‚¿ãƒƒãƒ—ã—ã¦é–‹å§‹</p>
</div>


<a-scene id="scene" background="color: #5af">

  <!-- ã‚¢ã‚»ãƒƒãƒˆç®¡ç† -->
  <a-assets>
    <img id="sky" src="kloppenheim_06_puresky_small.jpg">
    <video id="movie_main3" src="assets/VR_Video_MainScreen_Anim_NoAudio.mp4" loop muted playsinline></video>
    <video id="movie" src="assets/TEST-1.mp4" loop muted playsinline></video>
    <a-asset-item id="dome" src="assets/BOD_v9_Env.glb"></a-asset-item>
    <a-asset-item id="screen" src="assets/BOD_v4_Screen.glb"></a-asset-item>
    <a-asset-item id="panels" src="assets/BOD_v1_Panels.glb"></a-asset-item>
    <a-asset-item id="dispenser" src="assets/BOD_Dispenser_v1.glb"></a-asset-item>

	<!-- ç”»åƒãƒ‡ãƒ¼ã‚¿ -->
	<img id="panel1-img" src="assets/panel1.jpg">
	<img id="panel2-img" src="assets/panel2.jpg">

  </a-assets>

	<!-- ãƒã‚¦ã‚¹ã‚«ãƒ¼ã‚½ãƒ« -->
	<a-entity id="mouseCursor" cursor="rayOrigin: mouse" raycaster="objects: .raycastable"></a-entity>


  <!-- ç©ºï¼ˆå›è»¢ã§å‘ãèª¿æ•´ï¼‰ -->
  <a-sky src="#sky" rotation="0 -90 0" radius="1000"></a-sky>


  <!-- æ¹¾æ›²ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ -->
  <a-gltf-model
	src="#screen"
	position="0 0 0"
	rotation="0 -90 0"
	scale="2 2 2"
	id="model_mainScreen"
	material="src: #movie_main3"
	class="raycastable" 
	detection>
  </a-gltf-model>
	
  <!-- ãƒ‰ãƒ¼ãƒ  -->
  <a-gltf-model
    src="#dome"
    position="0 0 0"
	rotation="0 -90 0"
    scale="2 2 2">
  </a-gltf-model>

  <a-sphere color="blue" position="1.5,0.1,0.0" radius="0.02"></a-sphere>
  <a-sphere color="blue" position="1.0,0.1,0.0" radius="0.02"></a-sphere>
  <a-sphere color="red" position="-1.5,0.1,0.0" radius="0.02"></a-sphere>
  <a-sphere color="red" position="-1.0,0.1,0.0" radius="0.02"></a-sphere>
  <a-sphere color="green" position="0.0,0.1,0.3" radius="0.02"></a-sphere>
  <a-sphere color="green" position="0.0,0.1,0.2" radius="0.02"></a-sphere>
  <a-sphere color="yellow" position="0.0,0.4,0.1" radius="0.02"></a-sphere>
  <a-sphere color="yellow" position="0.0,0.4,0.0" radius="0.02"></a-sphere>
	
	<!-- ãƒ‡ã‚£ã‚¹ãƒšãƒ³ã‚µãƒ¼ -->
	<a-gltf-model
		src="#dispenser"
		position="-0.7 0 0.7"
		rotation="0 45 0"
		scale="0.08 0.08 0.08"
		class="raycastable" 
		id="model_dispenser"
		detection>
	</a-gltf-model>
	
	<!-- å‹•ç”»ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ -->
	<a-plane
		position="0 0.2 0"
		rotation="0 0 0"
		width="0.25"
		height="0.14"
		material="src: #panel1-img; shader: flat; color:#fff"
		id="model_samplePanel"
		class="raycastable" 
		detection>
	</a-plane>





	<!-- ã‚«ãƒ¡ãƒ©ãƒªã‚°ï¼ˆå††å½¢ç§»å‹•åˆ¶é™ï¼‰ -->

	<a-entity light="type: directional; color: #fff0e0; intensity: 1.0" position="-0.1 -0.2 1"></a-entity>
	<a-entity light="type: point; color: #fff8f0; intensity: 5.0" position="0 1 0"></a-entity>

	<a-entity id="rig"
		position="0 -1.3 0.5"
		relative-move="speed: 0.03; radius: 1.5">
			<a-camera
				look-controls
				raycaster="objects: .clickable"
				cursor="rayOrigin: entity"
				near="0.05">
			</a-camera>
	</a-entity>
	

</a-scene>

<script>

	function closeInfo(){
		const infoPage = document.getElementById('popup');
		infoPage.style.visibility = 'hidden';
		infoPage.style.opacity = 0;
		infoPage.style.transition='all 0.3s';
	}

	AFRAME.registerComponent('detection', {
		init:function(){
			this.el.addEventListener('click', function(evt){
				console.log('Clicked - Obj ID: ', this.id);//[this.id] or [evt.detail.intersection.object.el.id]
				const infoPage = document.getElementById('popup');
				/*infoPage.style.display = 'block';*/
				infoPage.style.visibility = 'visible';
				infoPage.style.opacity = 1;
				infoPage.style.transition='all 0.3s';
				
				const popupContent = infoTexts.find(member => {
					return member.id === this.id;
				});
				console.log(popupContent.description);
				//document.getElementById('popup_text').textContent = popupContent.description;
				document.getElementById('popup_text_title').innerHTML = popupContent.title;
				document.getElementById('popup_text_main').innerHTML = popupContent.description;
				document.getElementById('popup_imgTag').src = popupContent.image;
			});
		}
	});
	
	const scene = document.getElementById('scene');
	
	//***** æ¡ˆå†…è¡¨ç¤º *****
	const intro = document.getElementById('intro');
	intro.addEventListener('click', () => {
	  	intro.style.display = 'none';
	  	document.getElementById('movie').play();
	  	document.getElementById('movie_main3').play();
	});
		
	//***** å‹•ç”»å†ç”Ÿ *****
	document.body.addEventListener('click', () => {
	  	console.log('Body clicked! : movie starts');
	  	document.getElementById('movie').play();
	  	document.getElementById('movie_main3').play();
	}, { once: true });

	
	//***** èª­ã¿è¾¼ã¿å®Œäº†å‡¦ç†ï¼ˆèª­ã¿è¾¼ã¿è¡¨ç¤ºçµ‚äº†ï¼‰ *****
	scene.addEventListener('loaded', () => {
		console.log('Data loaded');
		const loading = document.getElementById('loading');
		loading.style.display = 'none';
	});
	
	
	//***** å‹•ç”»è²¼ã‚Šä»˜ã‘ã€€ï¼‹ã€€ç”»åƒè²¼ã‚Šä»˜ã‘ *****
	const screenEl = document.querySelector('a-gltf-model[src="#screen"]');
	screenEl.addEventListener('model-loaded', () => {
		const root = screenEl.getObject3D('mesh');
		if (!root) return;
		const video = document.getElementById('movie_main3');
		
		const videoTexture = new AFRAME.THREE.VideoTexture(video);
		videoTexture.flipY = false;
		videoTexture.colorSpace = AFRAME.THREE.SRGBColorSpace;
		videoTexture.needsUpdate = true;
		
		root.traverse(obj => {
			console.log(obj.type, obj.name);
			if (obj.type === 'Mesh' && obj.name === 'Screen') {
				console.log('Screen Found');
				obj.material.color.setRGB(1, 1, 1);
				obj.material.map = videoTexture;
				obj.material.needsUpdate = true;
				
				console.log('ğŸ¥ Video texture applied to:', obj.name);
			}
		});
	});
	
		
	//***** èª¬æ˜æ–‡è¿½åŠ  *****
	

    const infoTexts = [
      {
		id: 'model_mainScreen',
        title: 'åŸºèª¿ãƒ«ãƒ¼ãƒ—æ˜ åƒ',
		image: 'assets/IMG_1043.jpeg',
        description: 'å¯¾é¦¬ã‚¦ã‚£ãƒ¼ã‚¯æœŸé–“ä¸­ã€Cãƒ‰ãƒ¼ãƒ ã§ã¯é‡‘æ²¢ç¾è¡“å·¥èŠ¸å¤§å­¦ã¨ç«‹æ•™å¤§å­¦ã®å­¦ç”ŸãŒåˆ¶ä½œã—ãŸæ˜ åƒã‚’ä¸Šæ˜ ã—ã¾ã—ãŸã€‚<br>è¨ˆï¼”ã¤ã®æ˜ åƒã®ã†ã¡ã€ã“ã“ã§ã¯SDGsã‚„æµ·æ´‹å•é¡Œã«ã¤ã„ã¦è€ƒãˆè§£æ±ºã®ãŸã‚ã®ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å…±æœ‰ã™ã‚‹ãƒ ãƒ¼ãƒ“ãƒ¼ã‚’ã”è¦§ã„ãŸã ã‘ã¾ã™ã€‚'
      },
      {
		id: 'panel_1',
        title: 'ã‚¿ã‚¤ãƒˆãƒ«1',
		image: 'assets/panel1.jpg',
        description: 'Aã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã€€ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ã€‚'
      },
      {
		id: 'panel_2',
        title: 'ã‚¿ã‚¤ãƒˆãƒ«2',
		image: 'assets/panel2.jpg',
        description: 'Bã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã€€ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ã€‚'
      },
      {
		id: 'panel_3',
        title: 'ã‚¿ã‚¤ãƒˆãƒ«3',
		image: 'assets/panel3.jpg',
        description: 'Cã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã€€ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ã€‚'
      },
      {
		id: 'model_samplePanel',
        title: 'ã‚µãƒ³ãƒ—ãƒ«ãƒ‘ãƒãƒ«',
		image: 'assets/panel4.jpg',
        description: 'ã‚µãƒ³ãƒ—ãƒ«ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã€€ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ã€‚'
      },
      {
		id: 'model_dispenser',
        title: 'SARAYAã®ãƒ‡ã‚£ã‚¹ãƒšãƒ³ã‚µãƒ¼',
		image: 'https://www.saraya.com/themes/expo2025@saraya/images/dispenser_main.png',
        description: 'æ—¥æœ¬åˆã®è–¬ç”¨çŸ³ã‘ã‚“æ¶²ã¨å°‚ç”¨å®¹å™¨ã‚’é–‹ç™ºã—ã€æ‰‹æ´—ã„ç¿’æ…£ã‚’åºƒã’ã‚‹ã“ã¨ã‹ã‚‰äº‹æ¥­ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆã—ãŸã‚µãƒ©ãƒ¤ã€‚<br>æœªæ¥ã®æ¶ˆæ¯’ã®ã‹ãŸã¡ã‚’è€ƒãˆã€ã‚ãŸã‚‰ã—ã„è‡ªå‹•æ‰‹æŒ‡æ¶ˆæ¯’ãƒ‡ã‚£ã‚¹ãƒšãƒ³ã‚µãƒ¼ã‚’ã¤ãã‚Šã¾ã—ãŸã€‚<br><br><a href="https://www.saraya.com/expo2025/dispenser.html">ãƒ‡ã‚£ã‚¹ãƒšãƒ³ã‚µãƒ¼ã«ã¤ã„ã¦ã‚‚ã£ã¨çŸ¥ã‚‹</a>'
      }
];
	
</script>

</body>
</html>
